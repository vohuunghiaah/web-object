<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Admin Products Page" />
    <title>Admin</title>
    <link rel="stylesheet" href="admin.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.css"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
      /* ========== DARK THEME FOR REPORTS ========== */
      body {
        background-color: #0f172a;
        color: #f1f5f9;
        font-family: "Segoe UI", sans-serif;
      }

      .admin-main {
        display: flex;
        min-height: 100vh;
      }

      .sidebar {
        background-color: #1e293b;
        width: 220px;
        padding: 20px 0;
      }

      .sidebar ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .sidebar button {
        background: none;
        border: none;
        color: #cbd5e1;
        font-size: 15px;
        width: 100%;
        text-align: left;
        padding: 12px 20px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .sidebar button:hover {
        background-color: #334155;
        color: #38bdf8;
      }

      .admin-content {
        flex: 1;
        padding: 20px;
      }

      /* ====== Reports Section ====== */
      #reports {
        background-color: #0f172a;
        color: #f1f5f9;
        border-radius: 16px;
        padding: 20px;
      }

      .report-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
      }

      .btn-export {
        background-color: #38bdf8;
        border: none;
        color: #fff;
        padding: 10px 14px;
        border-radius: 8px;
        cursor: pointer;
      }

      .btn-export:hover {
        background-color: #0284c7;
      }

      .report-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 16px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: #1e293b;
        padding: 18px;
        border-radius: 12px;
        position: relative;
      }

      .stat-card h3 {
        font-size: 14px;
        color: #94a3b8;
      }

      .stat-card .value {
        font-size: 22px;
        margin-top: 6px;
        color: #f8fafc;
      }

      .stat-card .trend {
        position: absolute;
        top: 18px;
        right: 18px;
        font-size: 13px;
      }

      .green .trend {
        color: #4ade80;
      }
      .blue .trend {
        color: #38bdf8;
      }
      .orange .trend {
        color: #facc15;
      }
      .red .trend {
        color: #f87171;
      }

      .charts-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
      }

      .chart-card {
        background: #1e293b;
        padding: 16px;
        border-radius: 12px;
      }

      .chart-card h3 {
        margin-bottom: 10px;
        color: #e2e8f0;
        font-size: 16px;
      }
      /* ===== T√πy ch·ªânh ti√™u ƒë·ªÅ b√°o c√°o ===== */
      #reports h2 {
        text-align: center;
        color: #38bdf8; /* xanh cyan n·ªïi b·∫≠t */
        font-size: 26px;
        margin-bottom: 8px;
      }

      #reports .report-subtitle {
        text-align: center;
        color: #94a3b8; /* x√°m nh·∫°t d·ªÖ nh√¨n */
        font-size: 16px;
        margin-bottom: 25px;
      }
    </style>
  </head>

  <body>
    <div id="admin-wrapper">
      <header class="main-header">
        <div class="header-left">
          <span class="brand-title">Admin</span>
          <button class="close-btn">&times;</button>
        </div>
        <div class="header-divider"></div>
        <div class="header-right">
          <div class="actions">
            <button class="btn btn-account">
              <i class="fas fa-user-circle"></i> My account
            </button>
          </div>
        </div>
      </header>

      <div class="admin-main">
        <aside id="sidebar" class="sidebar">
          <ul>
            <li>
              <button onclick="navigateSPA('dashboard')">
                <i class="fas fa-home"></i> Dashboard
              </button>
            </li>
            <li>
              <button onclick="navigateSPA('orders')">
                <i class="fas fa-shopping-cart"></i> All order
              </button>
            </li>
            <li>
              <button onclick="navigateSPA('products')">
                <i class="fas fa-box"></i> Products
              </button>
            </li>
            <li>
              <button onclick="navigateSPA('invoices')">
                <i class="fas fa-file"></i> Invoices
              </button>
            </li>
            <li>
              <button onclick="navigateSPA('finance')">
                <i class="fas fa-coins"></i> Finance
              </button>
            </li>
            <li>
              <button onclick="navigateSPA('customers')">
                <i class="fas fa-users"></i> Customers
              </button>
            </li>
            <li>
              <button onclick="navigateSPA('discounts')">
                <i class="fas fa-tag"></i> Discounts
              </button>
            </li>
            <li>
              <button onclick="navigateSPA('reports')">
                <i class="fas fa-chart-bar"></i> Reports
              </button>
            </li>
            <li>
              <button onclick="navigateSPA('settings')">
                <i class="fas fa-cog"></i> Settings
              </button>
            </li>
          </ul>
        </aside>

        <section id="content" class="admin-content">
          <div id="dashboard" class="page">
            <h2>Dashboard Overview</h2>
            <p>T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn...</p>
          </div>

          <div id="products" class="page" style="display: none">
            <h2>Qu·∫£n l√Ω s·∫£n ph·∫©m</h2>
            <p>T√≠nh nƒÉng ƒëang ph√°t tri·ªÉn...</p>
          </div>

          <!--  Trang B√°o c√°o -->
          <!--  Trang B√°o c√°o & Ph√¢n t√≠ch (n√¢ng c·∫•p ƒë·∫πp h∆°n) -->
          <div id="reports" class="page" style="display: none">
            <h2>B√°o c√°o & Ph√¢n t√≠ch</h2>
            <p class="report-subtitle">
              T·ªïng quan doanh thu & ho·∫°t ƒë·ªông kinh doanh
            </p>

            <!--  Th·ªëng k√™ nhanh -->
            <div class="report-stats">
              <div class="stat-card green">
                <h3>T·ªïng doanh thu</h3>
                <p class="value">6,110,000,000‚Ç´</p>
                <span class="trend">+23%</span>
              </div>
              <div class="stat-card blue">
                <h3>T·ªïng ƒë∆°n h√†ng</h3>
                <p class="value">1,247</p>
                <span class="trend">+21%</span>
              </div>
              <div class="stat-card orange">
                <h3>Kh√°ch h√†ng m·ªõi</h3>
                <p class="value">486</p>
                <span class="trend">+15%</span>
              </div>
            </div>

            <!-- üîπ Bi·ªÉu ƒë·ªì -->
            <div class="charts-grid">
              <div class="chart-card">
                <h3>üìä Doanh thu theo th√°ng</h3>
                <canvas id="revenueChart"></canvas>
              </div>
              <div class="chart-card">
                <h3>üìà Ph√¢n b·ªë ƒë∆°n h√†ng</h3>
                <canvas id="orderChart"></canvas>
              </div>
            </div>

            <!--  B·∫£ng th·ªëng k√™ -->
            <div
              style="
                margin-top: 30px;
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
              "
            >
              <!-- Top kh√°ch h√†ng -->
              <div class="chart-card">
                <h3>üèÜ Kh√°ch h√†ng mua nhi·ªÅu nh·∫•t</h3>
                <table
                  style="width: 100%; border-collapse: collapse; color: #f8fafc"
                >
                  <thead style="background-color: #334155">
                    <tr>
                      <th style="padding: 8px; text-align: left">Kh√°ch h√†ng</th>
                      <th style="padding: 8px">S·ªë ƒë∆°n</th>
                      <th style="padding: 8px">T·ªïng chi (‚Ç´)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td style="padding: 8px">Nguy·ªÖn VƒÉn A</td>
                      <td style="padding: 8px; text-align: center">25</td>
                      <td style="padding: 8px; text-align: right">
                        35,000,000‚Ç´
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 8px">Tr·∫ßn Th·ªã B</td>
                      <td style="padding: 8px; text-align: center">18</td>
                      <td style="padding: 8px; text-align: right">
                        27,500,000‚Ç´
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 8px">Ph·∫°m Minh C</td>
                      <td style="padding: 8px; text-align: center">15</td>
                      <td style="padding: 8px; text-align: right">
                        22,000,000‚Ç´
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <!-- S·∫£n ph·∫©m b√°n ch·∫°y -->
              <div class="chart-card">
                <h3>S·∫£n ph·∫©m b√°n ch·∫°y nh·∫•t</h3>
                <table
                  style="width: 100%; border-collapse: collapse; color: #f8fafc"
                >
                  <thead style="background-color: #334155">
                    <tr>
                      <th style="padding: 8px; text-align: left">S·∫£n ph·∫©m</th>
                      <th style="padding: 8px">ƒê√£ b√°n</th>
                      <th style="padding: 8px">Doanh thu (‚Ç´)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td style="padding: 8px">Tai nghe Bluetooth X-Pro</td>
                      <td style="padding: 8px; text-align: center">480</td>
                      <td style="padding: 8px; text-align: right">
                        240,000,000‚Ç´
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 8px">Chu·ªôt gaming RGB</td>
                      <td style="padding: 8px; text-align: center">390</td>
                      <td style="padding: 8px; text-align: right">
                        195,000,000‚Ç´
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 8px">B√†n ph√≠m c∆° MK-300</td>
                      <td style="padding: 8px; text-align: center">350</td>
                      <td style="padding: 8px; text-align: right">
                        175,000,000‚Ç´
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- N√∫t xu·∫•t Excel -->
            <div style="text-align: right; margin-top: 20px">
              <button id="exportExcelBtn" class="btn-export">
                <i class="fas fa-file-excel"></i> Xu·∫•t Excel
              </button>
            </div>
          </div>
        </section>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // H√†m SPA ƒëi·ªÅu h∆∞·ªõng
      function navigateSPA(pageId) {
        document
          .querySelectorAll(".page")
          .forEach((p) => (p.style.display = "none"));
        document.getElementById(pageId).style.display = "block";
      }

      // V·∫Ω bi·ªÉu ƒë·ªì
      const ctxRevenue = document.getElementById("revenueChart");
      if (ctxRevenue) {
        new Chart(ctxRevenue, {
          type: "bar",
          data: {
            labels: [
              "T1",
              "T2",
              "T3",
              "T4",
              "T5",
              "T6",
              "T7",
              "T8",
              "T9",
              "T10",
              "T11",
              "T12",
            ],
            datasets: [
              {
                label: "Doanh thu (vn‚Ç´)",
                data: [
                  250000000, 300000000, 420000000, 350000000, 460000000,
                  510000000, 600000000, 550000000, 580000000, 610000000,
                  720000000, 760000000,
                ],
                backgroundColor: "#38bdf8",
              },
            ],
          },
          options: {
            responsive: true,
            scales: {
              x: { ticks: { color: "#cbd5e1" }, grid: { color: "#334155" } },
              y: { ticks: { color: "#cbd5e1" }, grid: { color: "#334155" } },
            },
            plugins: {
              legend: { labels: { color: "#f8fafc" } },
            },
          },
        });
      }

      const ctxOrder = document.getElementById("orderChart");
      if (ctxOrder) {
        new Chart(ctxOrder, {
          type: "doughnut",
          data: {
            labels: ["Online", "C·ª≠a h√†ng", "ƒê·ªëi t√°c"],
            datasets: [
              {
                data: [60, 30, 10],
                backgroundColor: ["#38bdf8", "#4ade80", "#facc15"],
              },
            ],
          },
          options: {
            plugins: {
              legend: { labels: { color: "#f8fafc" } },
            },
          },
        });
      }
      // === D·ªØ li·ªáu th·ªëng k√™ m·ªü r·ªông ===
      const bestProductsData = [
        { name: "Laptop ASUS ROG Strix G15", sold: 132, revenue: 198000000 },
        { name: "Tai nghe Sony WH-1000XM4", sold: 215, revenue: 107500000 },
        { name: "Chu·ªôt Logitech G Pro X", sold: 154, revenue: 46200000 },
        { name: "M√†n h√¨nh LG UltraGear 27''", sold: 92, revenue: 92000000 },
        { name: "B√†n ph√≠m c∆° Keychron K6", sold: 137, revenue: 54800000 },
      ];

      const topCustomersData = [
        { name: "Nguy·ªÖn VƒÉn A", orders: 15, total: 42800000 },
        { name: "Tr·∫ßn Th·ªã B", orders: 12, total: 39200000 },
        { name: "L√™ VƒÉn C", orders: 10, total: 32600000 },
        { name: "Ph·∫°m Th·ªã D", orders: 9, total: 28700000 },
        { name: "ƒê·ªó VƒÉn E", orders: 8, total: 25500000 },
      ];

      function renderReportTables() {
        const bestProductsTable = document.getElementById("bestProducts");
        const topCustomersTable = document.getElementById("topCustomers");

        if (bestProductsTable) {
          bestProductsData.forEach((p, i) => {
            bestProductsTable.innerHTML += `
        <tr>
          <td>${i + 1}</td>
          <td>${p.name}</td>
          <td>${p.sold}</td>
          <td>${p.revenue.toLocaleString("vi-VN")}</td>
        </tr>`;
          });
        }

        if (topCustomersTable) {
          topCustomersData.forEach((c, i) => {
            topCustomersTable.innerHTML += `
        <tr>
          <td>${i + 1}</td>
          <td>${c.name}</td>
          <td>${c.orders}</td>
          <td>${c.total.toLocaleString("vi-VN")}</td>
        </tr>`;
          });
        }
      }

      renderReportTables();
    </script>
    <!-- Th∆∞ vi·ªán h·ªó tr·ª£ xu·∫•t Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script>
      document
        .getElementById("exportExcelBtn")
        .addEventListener("click", function () {
          const tables = document.querySelectorAll("#reports table");

          if (tables.length === 0) {
            alert("Kh√¥ng t√¨m th·∫•y b·∫£ng d·ªØ li·ªáu ƒë·ªÉ xu·∫•t!");
            return;
          }

          const wb = XLSX.utils.book_new();

          tables.forEach((table, index) => {
            const ws = XLSX.utils.table_to_sheet(table);
            XLSX.utils.book_append_sheet(wb, ws, "B·∫£ng " + (index + 1));
          });

          XLSX.writeFile(wb, "BaoCao_KinhDoanh.xlsx");
        });
    </script>
  </body>
</html>
